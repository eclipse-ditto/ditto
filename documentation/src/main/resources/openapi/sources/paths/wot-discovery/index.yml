# Copyright (c) 2026 Contributors to the Eclipse Foundation
#
# See the NOTICE file(s) distributed with this work for additional
# information regarding copyright ownership.
#
# This program and the accompanying materials are made available under the
# terms of the Eclipse Public License 2.0 which is available at
# http://www.eclipse.org/legal/epl-2.0
#
# SPDX-License-Identifier: EPL-2.0
get:
  summary: Retrieve WoT Thing Directory
  description: |-
    Returns a WoT (Web of Things) Thing Description representing the Thing Directory of Eclipse Ditto.
    This endpoint implements the WoT Discovery specification, providing a standardized way to discover
    available Thing Descriptions.

    The returned Thing Description includes:
    - A `things` property that allows retrieving all Thing Descriptions with optional pagination
    - A `retrieveThing` action for fetching a specific Thing Description by its Thing ID

    The `retrieveThing` action requires the `Accept: application/td+json` header to receive
    a Thing Description format response.

    Note: By default, this endpoint is publicly accessible without authentication. This can be configured
    via the `GATEWAY_WOT_DIRECTORY_AUTHENTICATION_REQUIRED` environment variable.

    Both `GET` and `HEAD` methods are supported per the WoT Discovery specification.
  tags:
    - WoT
  responses:
    '200':
      description: |-
        The WoT Thing Directory description was successfully retrieved.
      content:
        application/td+json:
          schema:
            $ref: '../../schemas/wot-thingDescription.yml'
          example:
            '@context':
              - 'https://www.w3.org/2022/wot/td/v1.1'
              - 'https://www.w3.org/2022/wot/discovery'
            '@type': 'ThingDirectory'
            id: 'urn:ditto:wot:thing-directory'
            title: 'Thing Description Directory (TDD) of Eclipse Ditto'
            version:
              model: '1.0.0'
              instance: '1.0.0'
            base: 'http://localhost:8080'
            securityDefinitions:
              basic_sc:
                scheme: 'basic'
                in: 'header'
            security: 'basic_sc'
            properties:
              things:
                description: 'Retrieve all Thing Descriptions'
                readOnly: true
                uriVariables:
                  offset:
                    title: 'Offset'
                    description: 'Number of Thing Descriptions to skip for pagination'
                    type: 'integer'
                    minimum: 0
                  limit:
                    title: 'Limit'
                    description: 'Maximum number of Thing Descriptions to return'
                    type: 'integer'
                    minimum: 1
                  format:
                    title: 'Format'
                    description: "Response format: 'array' returns a plain JSON array of Thing Descriptions"
                    type: 'string'
                    enum:
                      - 'array'
                forms:
                  - href: 'api/2/things{?offset,limit,format}'
                    op: 'readproperty'
                    contentType: 'application/json'
            actions:
              retrieveThing:
                description: 'Retrieve a Thing Description by its Thing ID.'
                uriVariables:
                  thingId:
                    '@type': 'ThingID'
                    title: 'Thing ID'
                    type: 'string'
                    format: 'iri-reference'
                safe: true
                idempotent: true
                forms:
                  - href: 'api/2/things/{thingId}'
                    htv:methodName: 'GET'
                    htv:headers:
                      - htv:fieldName: 'Accept'
                        htv:fieldValue: 'application/td+json'
    '401':
      description: The request could not be completed due to missing authentication (when authentication is required).
      content:
        application/json:
          schema:
            $ref: '../../schemas/errors/advancedError.yml'
head:
  summary: Retrieve WoT Thing Directory headers
  description: |-
    Returns headers for the WoT Thing Directory endpoint without a response body.
    Supports the same authentication and configuration as the GET method.
  tags:
    - WoT
  responses:
    '200':
      description: The WoT Thing Directory headers were successfully retrieved.
    '401':
      description: The request could not be completed due to missing authentication (when authentication is required).
